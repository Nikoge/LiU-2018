---
title: "Computational Statistics (732A90) Lab1"
author: "Anubhav Dikshit(anudi287)"
date: "23 January 2019"
output: 
    pdf_document:
      toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

\newpage

## Question 1: Be careful when comparing
```{r}
x1 <- 1/3; x2 <- 1/4

if(x1-x2==1/12){
  print("Subtraction is correct")
}else{
  print("Subtraction is wrong")
}

x3 <- 1; x4<- 1/2
if(x3-x4==1/2){
  print("Subtraction is correct")
}else{
  print("Subtraction is wrong")
}

```

### 1. Check the results of the snippets. Comment what is going on.
### 2. If there are any problems, suggest improvements.
Answer: The numeric precision of the machine creates a barrier in evaluating the floating numbers, although both equation should return "Subtraction is correct", we get the other answer due to this very reason. One way to resolve this is to use *abs(x-y) <= tol* in R, where tol is a very small number that you can manually set, like so

```{r}
tol <- 1e-9
x1 <- 1/3; x2 <- 1/4

if(abs(x1-x2-1/12) <= tol){
  print("Subtraction is correct")
}else{
  print("Subtraction is wrong")
}

x3 <- 1; x4<- 1/2
if(abs(x3-x4-1/2) <= tol){
  print("Subtraction is correct")
}else{
  print("Subtraction is wrong")
}
```

##Question 2: Derivative

###1. Write your own function to find derivative```{r}

```{r}
my_deri <- function(x){
  epi = 10^(-15)
  f_deri <- ((x+epi) - x)/epi
  return(f_deri)
}

```

###2. Evaluate your derivative function at x = 1 and x = 100000.
```{r}
y_deri(x=1)
my_deri(x=100000)

```

###3. What values did you obtain? What are the true values? Explain the reasons behind the discovered differences.

We should have gotten both values as 0, however for *x=1* the derivate showed as 1.


## Question 3: Variance

###1. Write your own R function, myvar, to estimate the variance in this way.

```{r}

myvar <- function(myvector){
  #vector <- c(1,2,3,4,5)
  n <- length(myvector)
  answer <- (1/(n-1))*(sum(myvector^2) - (1/n) * ((sum(myvector))^2))
  return(answer)
} 

```

###2. Generate a vector x such that number of terms is 10000 random numbers with mean=10^8, and varience=1

```{r}

my_rand_num <- rnorm(n=10000, mean=10^8, sd=1)
```

###3. 3. For each subset x_i = (x1,x2,....xi), compute Y_i = myvar(X_i)-var(X_i), plot Y_i vs. i. Draw conclusions and plot.How well does your function work? Can you explain the behaviour?

```{r}
Y <- vector(mode = "logical", length = length(my_rand_num))
my_mat <- NULL
for(i in 1:length(my_rand_num)){
  X_i = my_rand_num[1:i]
  Y = myvar(X_i) - var(X_i)
  my_mat <- cbind(i, Y)
  return(my_mat)
}

```

 Appendix
```{r, ref.label=knitr::all_labels(),echo=TRUE,eval=FALSE}
```